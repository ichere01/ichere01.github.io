<!DOCTYPE html>

<html>

  <head>
    <title>Geolocation Map Example</title>
    <link rel="stylesheet" href="map_style.css">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=true&amp;libraries=places"></script>
    
    <script>
  
     
 
      function initialize()
      {
         var myOptions = {
            zoom: 12, 
            center: new google.maps.LatLng(myLat, myLng),
            mapTypeId: google.maps.MapTypeId.ROADMAP
          };
      
        var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
        get_positions(data,map);
      }

      var myLat = 42.3;
      var myLng = -71.1;
      data = JSON.parse('{ "TripList": {"CurrentTime": 1413407108,"Line": "Red", "Trips": [{"TripID": "23850600", "Destination": "Alewife", "Predictions": [ {"StopID": "70094", "Stop": "Ashmont", "Seconds": 532}, {"StopID": "70092", "Stop": "Shawmut", "Seconds": 604}, {"StopID": "70090", "Stop": "Fields Corner", "Seconds": 718}, {"StopID": "70088", "Stop": "Savin Hill", "Seconds": 892}, {"StopID": "70086", "Stop": "JFK/UMass", "Seconds": 1027}]}, {"TripID": "23850636", "Destination": "Ashmont", "Predictions": [ {"StopID": "70061", "Stop": "Alewife", "Seconds": 415}, {"StopID": "70063", "Stop": "Davis", "Seconds": 525}, {"StopID": "70065", "Stop": "Porter Square", "Seconds": 646}, {"StopID": "70067", "Stop": "Harvard Square", "Seconds": 806}, {"StopID": "70069", "Stop": "Central Square", "Seconds": 1026}, {"StopID": "70071", "Stop": "Kendall/MIT", "Seconds": 1182}]}, {"TripID": "23850755", "Destination": "Alewife", "Position": {"Timestamp": 1413407073, "Train": "1640", "Lat": 42.27878, "Long": -71.03228,"Heading": 345}, "Predictions": [ {"StopID": "70096", "Stop": "JFK/UMass", "Seconds": 392}, {"StopID": "70084", "Stop": "Andrew", "Seconds": 560}, {"StopID": "70082", "Stop": "Broadway", "Seconds": 692}, {"StopID": "70080", "Stop": "South Station", "Seconds": 848}, {"StopID": "70078", "Stop": "Downtown Crossing", "Seconds": 956}, {"StopID": "70076", "Stop": "Park Street", "Seconds": 1085}]}, {"TripID": "23850631", "Destination": "Ashmont", "Position": {"Timestamp": 1413407023, "Train": "1602", "Lat": 42.30377, "Long": -71.05578,"Heading": 195}, "Predictions": [ {"StopID": "70091", "Stop": "Shawmut", "Seconds": 106}, {"StopID": "70093", "Stop": "Ashmont", "Seconds": 257}]}, {"TripID": "23850595", "Destination": "Alewife", "Position": {"Timestamp": 1413407070, "Train": "1606", "Lat": 42.37407, "Long": -71.11876,"Heading": 350}, "Predictions": [ {"StopID": "70066", "Stop": "Porter Square", "Seconds": 157}, {"StopID": "70064", "Stop": "Davis", "Seconds": 270}, {"StopID": "70061", "Stop": "Alewife", "Seconds": 520}]}, {"TripID": "23850633", "Destination": "Ashmont", "Position": {"Timestamp": 1413407067, "Train": "1868", "Lat": 42.3617, "Long": -71.0776,"Heading": 95}, "Predictions": [ {"StopID": "70073", "Stop": "Charles/MGH", "Seconds": 1}, {"StopID": "70075", "Stop": "Park Street", "Seconds": 145}, {"StopID": "70077", "Stop": "Downtown Crossing", "Seconds": 265}, {"StopID": "70079", "Stop": "South Station", "Seconds": 380}, {"StopID": "70081", "Stop": "Broadway", "Seconds": 558}, {"StopID": "70083", "Stop": "Andrew", "Seconds": 696}, {"StopID": "70085", "Stop": "JFK/UMass", "Seconds": 852}, {"StopID": "70087", "Stop": "Savin Hill", "Seconds": 1015}, {"StopID": "70089", "Stop": "Fields Corner", "Seconds": 1197}]}, {"TripID": "23850598", "Destination": "Alewife", "Position": {"Timestamp": 1413407062, "Train": "1878", "Lat": 42.3028, "Long": -71.05578,"Heading": 5}, "Predictions": [ {"StopID": "70088", "Stop": "Savin Hill", "Seconds": 12}, {"StopID": "70086", "Stop": "JFK/UMass", "Seconds": 147}, {"StopID": "70084", "Stop": "Andrew", "Seconds": 316}, {"StopID": "70082", "Stop": "Broadway", "Seconds": 448}, {"StopID": "70080", "Stop": "South Station", "Seconds": 604}, {"StopID": "70078", "Stop": "Downtown Crossing", "Seconds": 712}, {"StopID": "70076", "Stop": "Park Street", "Seconds": 841}, {"StopID": "70074", "Stop": "Charles/MGH", "Seconds": 994}, {"StopID": "70072", "Stop": "Kendall/MIT", "Seconds": 1147}]}, {"TripID": "23850758", "Destination": "Alewife", "Predictions": [ {"StopID": "70105", "Stop": "Braintree", "Seconds": 592}, {"StopID": "70104", "Stop": "Quincy Adams", "Seconds": 825}, {"StopID": "70102", "Stop": "Quincy Center", "Seconds": 1013}, {"StopID": "70100", "Stop": "Wollaston", "Seconds": 1191}]}, {"TripID": "23850601", "Destination": "Alewife", "Predictions": [ {"StopID": "70094", "Stop": "Ashmont", "Seconds": 1012}, {"StopID": "70092", "Stop": "Shawmut", "Seconds": 1084}, {"StopID": "70090", "Stop": "Fields Corner", "Seconds": 1198}]}, {"TripID": "23850753", "Destination": "Alewife", "Position": {"Timestamp": 1413407040, "Train": "1864", "Lat": 42.35107, "Long": -71.05232,"Heading": 355}, "Predictions": [ {"StopID": "70080", "Stop": "South Station", "Seconds": -26}, {"StopID": "70078", "Stop": "Downtown Crossing", "Seconds": 69}, {"StopID": "70076", "Stop": "Park Street", "Seconds": 212}, {"StopID": "70074", "Stop": "Charles/MGH", "Seconds": 365}, {"StopID": "70072", "Stop": "Kendall/MIT", "Seconds": 518}, {"StopID": "70070", "Stop": "Central Square", "Seconds": 680}, {"StopID": "70068", "Stop": "Harvard Square", "Seconds": 886}, {"StopID": "70066", "Stop": "Porter Square", "Seconds": 1081}]}, {"TripID": "23850759", "Destination": "Alewife", "Predictions": [ {"StopID": "70105", "Stop": "Braintree", "Seconds": 1132}]}, {"TripID": "23850757", "Destination": "Alewife", "Predictions": [ {"StopID": "70105", "Stop": "Braintree", "Seconds": 112}, {"StopID": "70104", "Stop": "Quincy Adams", "Seconds": 344}, {"StopID": "70102", "Stop": "Quincy Center", "Seconds": 532}, {"StopID": "70100", "Stop": "Wollaston", "Seconds": 714}, {"StopID": "70098", "Stop": "North Quincy", "Seconds": 846}]}, {"TripID": "23850698", "Destination": "Braintree", "Predictions": [ {"StopID": "70061", "Stop": "Alewife", "Seconds": 337}, {"StopID": "70063", "Stop": "Davis", "Seconds": 447}, {"StopID": "70065", "Stop": "Porter Square", "Seconds": 568}, {"StopID": "70067", "Stop": "Harvard Square", "Seconds": 728}, {"StopID": "70069", "Stop": "Central Square", "Seconds": 948}, {"StopID": "70071", "Stop": "Kendall/MIT", "Seconds": 1104}]}, {"TripID": "23850700", "Destination": "Braintree", "Predictions": [ {"StopID": "70061", "Stop": "Alewife", "Seconds": 952}, {"StopID": "70063", "Stop": "Davis", "Seconds": 1062}, {"StopID": "70065", "Stop": "Porter Square", "Seconds": 1183}]}, {"TripID": "23850635", "Destination": "Ashmont", "Predictions": [ {"StopID": "70061", "Stop": "Alewife", "Seconds": 193}, {"StopID": "70063", "Stop": "Davis", "Seconds": 303}, {"StopID": "70065", "Stop": "Porter Square", "Seconds": 424}, {"StopID": "70067", "Stop": "Harvard Square", "Seconds": 584}, {"StopID": "70069", "Stop": "Central Square", "Seconds": 804}, {"StopID": "70071", "Stop": "Kendall/MIT", "Seconds": 960}]}, {"TripID": "23850634", "Destination": "Ashmont", "Position": {"Timestamp": 1413407073, "Train": "1757", "Lat": 42.37396, "Long": -71.11874,"Heading": 130}, "Predictions": [ {"StopID": "70069", "Stop": "Central Square", "Seconds": 185}, {"StopID": "70071", "Stop": "Kendall/MIT", "Seconds": 341}, {"StopID": "70073", "Stop": "Charles/MGH", "Seconds": 497}, {"StopID": "70075", "Stop": "Park Street", "Seconds": 641}, {"StopID": "70077", "Stop": "Downtown Crossing", "Seconds": 761}, {"StopID": "70079", "Stop": "South Station", "Seconds": 876}, {"StopID": "70081", "Stop": "Broadway", "Seconds": 1054}, {"StopID": "70083", "Stop": "Andrew", "Seconds": 1192}]}, {"TripID": "23850599", "Destination": "Alewife", "Predictions": [ {"StopID": "70094", "Stop": "Ashmont", "Seconds": -8}, {"StopID": "70092", "Stop": "Shawmut", "Seconds": 64}, {"StopID": "70090", "Stop": "Fields Corner", "Seconds": 178}, {"StopID": "70088", "Stop": "Savin Hill", "Seconds": 349}, {"StopID": "70086", "Stop": "JFK/UMass", "Seconds": 484}]}, {"TripID": "23850696", "Destination": "Braintree", "Position": {"Timestamp": 1413407050, "Train": "1852", "Lat": 42.35954, "Long": -71.06784,"Heading": 130}, "Predictions": [ {"StopID": "70075", "Stop": "Park Street", "Seconds": -12}, {"StopID": "70077", "Stop": "Downtown Crossing", "Seconds": 108}, {"StopID": "70079", "Stop": "South Station", "Seconds": 223}, {"StopID": "70081", "Stop": "Broadway", "Seconds": 399}, {"StopID": "70083", "Stop": "Andrew", "Seconds": 537}, {"StopID": "70095", "Stop": "JFK/UMass", "Seconds": 692}, {"StopID": "70097", "Stop": "North Quincy", "Seconds": 1159}]}, {"TripID": "23850699", "Destination": "Braintree", "Predictions": [ {"StopID": "70061", "Stop": "Alewife", "Seconds": 576}, {"StopID": "70063", "Stop": "Davis", "Seconds": 686}, {"StopID": "70065", "Stop": "Porter Square", "Seconds": 807}, {"StopID": "70067", "Stop": "Harvard Square", "Seconds": 967}, {"StopID": "70069", "Stop": "Central Square", "Seconds": 1187}]}, {"TripID": "23850697", "Destination": "Braintree", "Position": {"Timestamp": 1413407065, "Train": "1518", "Lat": 42.39774, "Long": -71.13272,"Heading": 95}, "Predictions": [ {"StopID": "70063", "Stop": "Davis", "Seconds": 4}, {"StopID": "70065", "Stop": "Porter Square", "Seconds": 125}, {"StopID": "70067", "Stop": "Harvard Square", "Seconds": 285}, {"StopID": "70069", "Stop": "Central Square", "Seconds": 505}, {"StopID": "70071", "Stop": "Kendall/MIT", "Seconds": 661}, {"StopID": "70073", "Stop": "Charles/MGH", "Seconds": 819}, {"StopID": "70075", "Stop": "Park Street", "Seconds": 963}, {"StopID": "70077", "Stop": "Downtown Crossing", "Seconds": 1083}, {"StopID": "70079", "Stop": "South Station", "Seconds": 1198}]}, {"TripID": "23850594", "Destination": "Alewife", "Position": {"Timestamp": 1413407031, "Train": "1849", "Lat": 42.39538, "Long": -71.11944,"Heading": 340}, "Predictions": [ {"StopID": "70061", "Stop": "Alewife", "Seconds": 176}]}, {"TripID": "23850756", "Destination": "Alewife", "Position": {"Timestamp": 1413407069, "Train": "1728", "Lat": 42.24615, "Long": -71.00368,"Heading": 15}, "Predictions": [ {"StopID": "70102", "Stop": "Quincy Center", "Seconds": 33}, {"StopID": "70100", "Stop": "Wollaston", "Seconds": 211}, {"StopID": "70098", "Stop": "North Quincy", "Seconds": 343}, {"StopID": "70096", "Stop": "JFK/UMass", "Seconds": 858}, {"StopID": "70084", "Stop": "Andrew", "Seconds": 1026}, {"StopID": "70082", "Stop": "Broadway", "Seconds": 1158}]}, {"TripID": "23850750", "Destination": "Alewife", "Position": {"Timestamp": 1413406896, "Train": "1740", "Lat": 42.39676, "Long": -71.12241,"Heading": 285}, "Predictions": [ {"StopID": "70061", "Stop": "Alewife", "Seconds": 98}]}, {"TripID": "23850637", "Destination": "Ashmont", "Predictions": [ {"StopID": "70061", "Stop": "Alewife", "Seconds": 759}, {"StopID": "70063", "Stop": "Davis", "Seconds": 844}, {"StopID": "70065", "Stop": "Porter Square", "Seconds": 965}, {"StopID": "70067", "Stop": "Harvard Square", "Seconds": 1125}]}, {"TripID": "23850754", "Destination": "Alewife", "Position": {"Timestamp": 1413407075, "Train": "1870", "Lat": 42.3233, "Long": -71.05299,"Heading": 315}, "Predictions": [ {"StopID": "70084", "Stop": "Andrew", "Seconds": 53}, {"StopID": "70082", "Stop": "Broadway", "Seconds": 185}, {"StopID": "70080", "Stop": "South Station", "Seconds": 341}, {"StopID": "70078", "Stop": "Downtown Crossing", "Seconds": 449}, {"StopID": "70076", "Stop": "Park Street", "Seconds": 578}, {"StopID": "70074", "Stop": "Charles/MGH", "Seconds": 731}, {"StopID": "70072", "Stop": "Kendall/MIT", "Seconds": 884}, {"StopID": "70070", "Stop": "Central Square", "Seconds": 1046}]}, {"TripID": "23850693", "Destination": "Braintree", "Position": {"Timestamp": 1413407071, "Train": "1511", "Lat": 42.2734, "Long": -71.02786,"Heading": 135}, "Predictions": [ {"StopID": "70099", "Stop": "Wollaston", "Seconds": 10}, {"StopID": "70101", "Stop": "Quincy Center", "Seconds": 181}, {"StopID": "70103", "Stop": "Quincy Adams", "Seconds": 372}, {"StopID": "70105", "Stop": "Braintree", "Seconds": 636}]}, {"TripID": "23850597", "Destination": "Alewife", "Position": {"Timestamp": 1413407053, "Train": "1857", "Lat": 42.34273, "Long": -71.05707,"Heading": 350}, "Predictions": [ {"StopID": "70080", "Stop": "South Station", "Seconds": 101}, {"StopID": "70078", "Stop": "Downtown Crossing", "Seconds": 209}, {"StopID": "70076", "Stop": "Park Street", "Seconds": 339}, {"StopID": "70074", "Stop": "Charles/MGH", "Seconds": 492}, {"StopID": "70072", "Stop": "Kendall/MIT", "Seconds": 645}, {"StopID": "70070", "Stop": "Central Square", "Seconds": 807}, {"StopID": "70068", "Stop": "Harvard Square", "Seconds": 1013}]}, {"TripID": "23850817", "Destination": "Braintree", "Position": {"Timestamp": 1413407064, "Train": "1841", "Lat": 42.36994, "Long": -71.11294,"Heading": 125}, "Predictions": [ {"StopID": "70069", "Stop": "Central Square", "Seconds": 19}, {"StopID": "70071", "Stop": "Kendall/MIT", "Seconds": 175}, {"StopID": "70073", "Stop": "Charles/MGH", "Seconds": 333}, {"StopID": "70075", "Stop": "Park Street", "Seconds": 477}, {"StopID": "70077", "Stop": "Downtown Crossing", "Seconds": 597}, {"StopID": "70079", "Stop": "South Station", "Seconds": 712}, {"StopID": "70081", "Stop": "Broadway", "Seconds": 890}, {"StopID": "70083", "Stop": "Andrew", "Seconds": 1028}, {"StopID": "70095", "Stop": "JFK/UMass", "Seconds": 1183}]}, {"TripID": "23850751", "Destination": "Alewife", "Position": {"Timestamp": 1413407052, "Train": "1823", "Lat": 42.38416, "Long": -71.11936,"Heading": 0}, "Predictions": [ {"StopID": "70066", "Stop": "Porter Square", "Seconds": -26}, {"StopID": "70064", "Stop": "Davis", "Seconds": 112}, {"StopID": "70061", "Stop": "Alewife", "Seconds": 337}]}, {"TripID": "23850596", "Destination": "Alewife", "Position": {"Timestamp": 1413407059, "Train": "1726", "Lat": 42.3565, "Long": -71.06263,"Heading": 310}, "Predictions": [ {"StopID": "70074", "Stop": "Charles/MGH", "Seconds": 104}, {"StopID": "70072", "Stop": "Kendall/MIT", "Seconds": 257}, {"StopID": "70070", "Stop": "Central Square", "Seconds": 419}, {"StopID": "70068", "Stop": "Harvard Square", "Seconds": 625}, {"StopID": "70066", "Stop": "Porter Square", "Seconds": 820}, {"StopID": "70064", "Stop": "Davis", "Seconds": 958}, {"StopID": "70061", "Stop": "Alewife", "Seconds": 1183}]}, {"TripID": "23850694", "Destination": "Braintree", "Position": {"Timestamp": 1413407067, "Train": "1711", "Lat": 42.31602, "Long": -71.05206,"Heading": 170}, "Predictions": [ {"StopID": "70097", "Stop": "North Quincy", "Seconds": 336}, {"StopID": "70099", "Stop": "Wollaston", "Seconds": 475}, {"StopID": "70101", "Stop": "Quincy Center", "Seconds": 646}, {"StopID": "70103", "Stop": "Quincy Adams", "Seconds": 837}, {"StopID": "70105", "Stop": "Braintree", "Seconds": 1101}]}, {"TripID": "23850818", "Destination": "Braintree", "Predictions": [ {"StopID": "70063", "Stop": "Davis", "Seconds": 64}, {"StopID": "70065", "Stop": "Porter Square", "Seconds": 185}, {"StopID": "70067", "Stop": "Harvard Square", "Seconds": 345}, {"StopID": "70069", "Stop": "Central Square", "Seconds": 565}, {"StopID": "70071", "Stop": "Kendall/MIT", "Seconds": 721}]}, {"TripID": "23850752", "Destination": "Alewife", "Position": {"Timestamp": 1413407019, "Train": "1752", "Lat": 42.36703, "Long": -71.10626,"Heading": 310}, "Predictions": [ {"StopID": "70068", "Stop": "Harvard Square", "Seconds": 39}, {"StopID": "70066", "Stop": "Porter Square", "Seconds": 233}, {"StopID": "70064", "Stop": "Davis", "Seconds": 371}, {"StopID": "70061", "Stop": "Alewife", "Seconds": 596}]}, {"TripID": "23850695", "Destination": "Braintree", "Position": {"Timestamp": 1413407011, "Train": "1614", "Lat": 42.35524, "Long": -71.06018,"Heading": 135}, "Predictions": [ {"StopID": "70079", "Stop": "South Station", "Seconds": 18}, {"StopID": "70081", "Stop": "Broadway", "Seconds": 194}, {"StopID": "70083", "Stop": "Andrew", "Seconds": 332}, {"StopID": "70095", "Stop": "JFK/UMass", "Seconds": 487}, {"StopID": "70097", "Stop": "North Quincy", "Seconds": 954}, {"StopID": "70099", "Stop": "Wollaston", "Seconds": 1092}]}, {"TripID": "23850632", "Destination": "Ashmont", "Position": {"Timestamp": 1413407056, "Train": "1708", "Lat": 42.3506, "Long": -71.05569,"Heading": 130}, "Predictions": [ {"StopID": "70081", "Stop": "Broadway", "Seconds": 18}, {"StopID": "70083", "Stop": "Andrew", "Seconds": 156}, {"StopID": "70085", "Stop": "JFK/UMass", "Seconds": 312}, {"StopID": "70087", "Stop": "Savin Hill", "Seconds": 475}, {"StopID": "70089", "Stop": "Fields Corner", "Seconds": 657}, {"StopID": "70091", "Stop": "Shawmut", "Seconds": 792}, {"StopID": "70093", "Stop": "Ashmont", "Seconds": 943}]}]}}');

      //get_positions(data, map);
      function get_positions(data, map){
        for(i = 0; i < data.TripList.Trips.length; i++){
          if(data.TripList.Trips[i].Position != null)
          {
            console.log("long: " + data.TripList.Trips[i].Position.Long);
            console.log("lat: " + data.TripList.Trips[i].Position.Lat);
            lon =  data.TripList.Trips[i].Position.Long;
            lat =  data.TripList.Trips[i].Position.Lat;
            addMarker(map,lat,lon);
          }
        }
      }

      function addMarker(map,lat,lon){
        var marker = new google.maps.Marker({position: new google.maps.LatLng(lat,lon),
          title: 'Red Line',
          map: map});

      }
     
      // var request = new XMLHttpRequest();
      // request.open("get",jsonred,true);
      // console.log(request.responsetext);
      // request.onreadystatechange = function (){
      //   if(request.readyState == 4 && request.status == 200){
      //     data = JSON.parse(request.responsetext);
      //     console.log("hello");
      //   }
      // }
      // request.send();
      
     
    </script>
  </head>
  
  <body onload="initialize()" >
    <div id="map_canvas"></div>
  </body>
</html>